# 更新日志

### 2025.11.03

1. 更新 OpenWrt-Arm64-MTFilogic-24.10.4(内核版本 6.6.110) 的 ipk 包
2. 更新 OpenWrt-Mipsel_24kc-MT7621-24.10.4(内核版本 6.6.110) 的 ipk 包

### 2025.11.10

1. 优化程序启动参数，现在 `通道选择` 参数为可选参数(默认为 pc 通道)，使用 -cpc 或 -cphone 切换相应通道

### 2025.11.14

1. 优化程序逻辑，修复了在 OpenWrt 系统中程序不能正确接收到 /etc/init.d/esurfingclient stop 的 SIGTERM 退出信号并且退出生成日志
2. 优化 ipk 包，现在更新包不会导致原配置被覆盖而需要重新填写，现在 ipk 包更新时检测到 /etc/config/esurfingclient 配置文件存在时，会生成 /etc/config/esurfingclient-opkg 配置文件而不会覆盖原配置文件
3. 修复了 OpenWrt 系统更新包时因为关闭程序和启动程序中间间隔过短导致的严重程序报错

> 关于第 2 点，就是现在 ipk 包更新不再需要重新填写个人的信息了，会自动用旧的配置

### 2025.11.16

1. 修复因为把 response_code 参数的 long 类型改成 int 类型导致的 Segmentation fault 段错误的问题
2. 尝试修复因为登录时长过久导致的 Invalid zsm data 并且无法上网的错误
3. (临时)优化日志系统，现在开启 debug 模式会让日志生成在 /usr/esurfing 目录中，而不是 /var/log/esurfing 中

### 2025.11.17

1. 优化日志系统，现在在 OpenWrt 系统开启 debug 模式会让日志生成在 /usr/esurfing 目录中，而不是在重启后就会清除的 /var/log/esurfing 目录中，其它系统仍旧
2. 将 Linux 版本做成静态链接版本，避免了因链接库版本不同导致的无法运行

### 2025.11.20

1. 全面汉化日志输出
2. 优化日志系统，为避免小容量的 OpenWrt 系统设备因为在开启 debug 模式之后容量不足，现添加一个新参数 `-s` (uci 配置则是 smallDevice 参数)，表示 smallDevice 小容量设备，默认开启，开启之后不管是否开启 debug 模式，都会将日志存储在 /var/log/esurfing 目录中，只有在同时满足 debug 模式开启和 smallDevice 模式关闭的条件下才会将日志存储到 /usr/esurfing 目录中，该参数仅对 OpenWrt 系统有效，其它系统启用无任何效果
3. 新增了一些报错提示
4. 取消 OpenWrt 系统安装 ipk 包时的配置选项保护，以保证默认配置文件能得到更新，每次更新需要重新设置配置文件，不过现在在 OpenWrt 系统中每次执行本程序，都会保存一个配置脚本在 /root/config.sh 中，以后每次更新都可以直接运行该脚本来更新自己的配置
5. 更换默认认证通道为更稳定的 `phone` 通道(因为今晚测试 `pc` 通道十分不稳定)

### 2025.11.21

1. 新增一些详细的日志报错

### 2025.12.01

1. 优化代码结构
2. 新增登录时间检测，在 1 天 23 小时 50 分钟后会自动重新认证 (服务器会在认证登录 1 天 23 小时 55 分钟后踢下线)

### 2025.12.04

1. 优化代码结构
2. 尝试修复重新认证机制的空指针错误